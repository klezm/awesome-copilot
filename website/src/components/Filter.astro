---
import type { Filter } from '../utils/data';

interface Props {
  filters: Filter[];
}

const { filters } = Astro.props;
---

<div class="filter-controls p-4 border border-base-content/10 rounded-lg bg-base-200/30 sticky top-24">
    <div class="flex justify-between items-center mb-4">
        <h3 class="text-xl font-bold">Filters</h3>
        <button type="reset" form="filter-form" class="btn btn-sm btn-ghost text-base-content/70 hover:bg-base-300">
            Clear All
        </button>
    </div>
    <form id="filter-form" class="space-y-2">
        <!-- Text Search -->
        <div class="collapse collapse-arrow bg-base-100/50">
            <input type="radio" name="filter-accordion" checked="checked" />
            <div class="collapse-title text-lg font-medium">
                Search
            </div>
            <div class="collapse-content">
                <input type="text" id="search-description" name="description" placeholder="By description..." class="input input-bordered w-full mt-2" />
            </div>
        </div>

        <!-- Dynamic Filters -->
        {filters.filter(f => f.id !== 'description').map(filter => (
            <div class="collapse collapse-arrow bg-base-100/50">
                <input type="radio" name="filter-accordion" />
                <div class="collapse-title text-lg font-medium">
                    {filter.name}
                </div>
                <div class="collapse-content">
                    <div class="flex flex-col gap-2 mt-2 max-h-60 overflow-y-auto">
                        {filter.options.map(option => (
                            <label class="label cursor-pointer justify-start gap-3">
                                <input type="checkbox" name={filter.id} value={option.value} class="checkbox checkbox-primary checkbox-sm" />
                                <span class="label-text">{option.value}</span>
                                <span class="label-text-alt ml-auto text-base-content/50">({option.count})</span>
                            </label>
                        ))}
                    </div>
                </div>
            </div>
        ))}
    </form>
</div>
